var ConvexHull;(function(h){var f=function(){function b(a,d,c){void 0===c&&(c=-1);this.angle=0;this.x=a;this.y=d;this.i=c}b.prototype.getX=function(){return this.x};b.prototype.getY=function(){return this.y};b.prototype.getI=function(){return this.i};b.prototype.getAngle=function(){return this.angle};b.prototype.setAngle=function(a){this.angle=a;return this};return b}();h.Point=f})(ConvexHull||(ConvexHull={}));
(function(h){var f=function(){function b(a,d){this.canvas=a;this.padding=d;this.width=a.width();this.height=a.height()}b.prototype.getWidth=function(){return this.width};b.prototype.getHeight=function(){return this.height};b.prototype.getPadding=function(){return this.padding};b.prototype.drawPoints=function(a){this.canvas.removeLayers().clearCanvas();for(var d=0,c=a.length;d<c;d++)this.drawPoint(""+d,a[d],"#000","#777")};b.prototype.drawPoint=function(a,d,c,e){this.canvas.drawArc({radius:3,layer:!0,
x:d.getX(),y:d.getY(),strokeWidth:1,groups:["point"],fillStyle:e,name:"point."+a,strokeStyle:c})};b.prototype.highlightPoint=function(a,d,c){this.canvas.setLayer("point."+a.getI(),{fillStyle:c,strokeStyle:d}).drawLayers()};b.prototype.drawPolygon=function(a,d,c){this.canvas.removeLayerGroup("polygon");for(var e=0,b=a.length;e<b;e++)this.highlightPoint(a[e],d,c),this.canvas.drawLine({layer:!0,strokeWidth:2,strokeStyle:c,groups:["polygon"],name:"polygonLine."+e,x1:a[e].getX(),y1:a[e].getY(),x2:a[(e+
1)%b].getX(),y2:a[(e+1)%b].getY()})};b.prototype.operationCountInfo=function(a,d,c){this.canvas.drawText({x:10,y:428,layer:!0,fontSize:12,align:"left",fillStyle:"#777",fromCenter:!1,name:"operationCount",text:a+" operations in "+d+"ms ("+c+")"})};b.prototype.clearSolution=function(){this.canvas.removeLayerGroup("polygon").removeLayer("operationCount").setLayerGroup("point",{fillStyle:"#777",strokeStyle:"#000"}).drawLayers()};return b}();h.Canvas=f})(ConvexHull||(ConvexHull={}));
(function(h){var f=function(){function b(){this.counter=0;this.polygon=[]}b.prototype.count=function(a){void 0===a&&(a=1);this.counter+=a;return this};b.prototype.getCounter=function(){return this.counter};b.prototype.addVertex=function(a){this.polygon.push(a);return this};b.prototype.getPolygon=function(){return this.polygon};b.prototype.sortPolygon=function(){this.polygon=h.Helpers.sortConvexPolygon(this.polygon);return this};return b}();h.Result=f})(ConvexHull||(ConvexHull={}));
(function(h){var f=function(){function b(){}b.sortConvexPolygon=function(a){for(var d=b.findCentroid(a),c=0,e=a.length;c<e;c++)a[c].setAngle(Math.atan2(a[c].getY()-d.getY(),a[c].getX()-d.getX()));a.sort(function(a,d){return a.getAngle()-d.getAngle()});return a};b.findCentroid=function(a){for(var d=0,c=0,e=0,b=a.length;e<b;e++)d+=a[e].getX(),c+=a[e].getY();return new h.Point(d/b,c/b)};b.laysPointInTriangle=function(a,d,c,e){return 0>=(c.getY()-d.getY())*(d.getX()-a.getX())+(d.getX()-c.getX())*(d.getY()-
a.getY())&&0>=(e.getY()-c.getY())*(c.getX()-a.getX())+(c.getX()-e.getX())*(c.getY()-a.getY())&&0>=(d.getY()-e.getY())*(e.getX()-a.getX())+(e.getX()-d.getX())*(e.getY()-a.getY())};b.findExtremes=function(a){for(var d=null,c=null,e=0,b=a.length;e<b;e++){if(null===d||a[e].getX()<d.getX())d=a[e];if(null===c||a[e].getX()>c.getX())c=a[e]}return{min:d,max:c}};b.vectorsAngle=function(a,d){return Math.atan2(a[0]*d[1]-d[0]*a[1],a[0]*d[0]+a[1]*d[1])};b.findFarthestPointFromLineToTheLeft=function(a,d,c){for(var e=
null,k=null,g=0,h=c.length;g<h;g++)if(c[g]!==a&&c[g]!==d&&b.isPointToTheLeftFromLine(c[g],a,d)){var f=b.pointFromLineDistance(c[g],a,d);if(null===k||f>k)e=c[g],k=f}return e};b.splitPointsByTriangle=function(a,d,c,e){for(var k=[[],[]],g=0,h=e.length;g<h;g++)e[g]!==a&&e[g]!==d&&e[g]!==c&&(b.laysPointInTriangle(e[g],a,d,c)||(b.isPointToTheLeftFromLine(e[g],a,c)?k[0].push(e[g]):b.isPointToTheLeftFromLine(e[g],c,d)&&k[1].push(e[g])));return k};b.isPointToTheLeftFromLine=function(a,d,c){return 0>(c.getX()-
d.getX())*(a.getY()-d.getY())-(c.getY()-d.getY())*(a.getX()-d.getX())};b.pointFromLineDistance=function(a,d,c){var e=c.getX()-d.getX(),b=c.getY()-d.getY();return Math.abs(b*a.getX()-e*a.getY()+c.getX()*d.getY())/Math.sqrt(e*e+b*b)};return b}();h.Helpers=f})(ConvexHull||(ConvexHull={}));
(function(h){var f=function(){function b(){}b.quickHull=function(a){var d=new h.Result,c=h.Helpers.findExtremes(a),e=c.min,c=c.max;d.count(a.length);d.addVertex(e);d.addVertex(c);b._quickHull(e,c,a,d);b._quickHull(c,e,a,d);d.sortPolygon();return d};b._quickHull=function(a,d,c,e){if(c.length){var k=h.Helpers.findFarthestPointFromLineToTheLeft(a,d,c);e.addVertex(k);e.count(c.length);var g=h.Helpers.splitPointsByTriangle(a,d,k,c);e.count(c.length);b._quickHull(a,k,g[0],e);b._quickHull(k,d,g[1],e)}};
b.giftWrapping=function(a){var d=new h.Result,c=h.Helpers.findExtremes(a).max,b=c,k=[0,-1];do{d.count();d.addVertex(b);for(var g=null,f=null,l=null,m=0,q=a.length;m<q;m++)if(a[m]!==b){d.count();var n=[a[m].getX()-b.getX(),a[m].getY()-b.getY()],p=h.Helpers.vectorsAngle(k,n);if(null===g||p<g)g=p,f=n,l=a[m]}k=f;b=l}while(b!==c);return d};b.primitive=function(a){for(var d=new h.Result,c=a.length,b=0;b<c;b++){for(var k=!0,g=0;k&&g<c;g++)if(b!==g)for(var f=0;k&&f<c;f++)if(b!==f&&g!==f)for(var l=0;k&&l<
c;l++)b!==l&&g!==l&&f!==l&&(d.count(),h.Helpers.laysPointInTriangle(a[b],a[g],a[f],a[l])&&(k=!1));k&&d.addVertex(a[b])}d.sortPolygon();return d};return b}();h.Solver=f})(ConvexHull||(ConvexHull={}));
(function(h){var f=function(){function b(a,b,c,e,f,g,h){this.pointCountSlider=a;this.pointCountInfo=b;this.generatorButton=c;this.quickHullButton=e;this.giftWrappingButton=f;this.primitiveButton=g;this.clearButton=h}b.prototype.getPointCountSlider=function(){return this.pointCountSlider};b.prototype.getPointCountInfo=function(){return this.pointCountInfo};b.prototype.getPointCount=function(){return parseInt(this.pointCountSlider.val())};b.prototype.getGeneratorButton=function(){return this.generatorButton};
b.prototype.getQuickHullButton=function(){return this.quickHullButton};b.prototype.getGiftWrappingButton=function(){return this.giftWrappingButton};b.prototype.getPrimitiveButton=function(){return this.primitiveButton};b.prototype.getClearButton=function(){return this.clearButton};return b}();h.Controls=f})(ConvexHull||(ConvexHull={}));
(function(h){var f=function(){function b(a,b){this.points=[];this.canvas=a;this.controls=b}b.prototype.run=function(){var a=this,b=function(){a.controls.getPointCountInfo().text(a.controls.getPointCount())};b();this.controls.getPointCountSlider().on("input change",function(a){b()});this.processAlgButtons(function(b){b.on("click",function(b){a.setAlgButtonsDisabled(!0)})});this.controls.getGeneratorButton().on("click",function(b){a.generatePoints(a.controls.getPointCount());a.canvas.drawPoints(a.points);
a.setAlgButtonsDisabled(!1)});this.controls.getQuickHullButton().on("click",function(b){a.runAlgorithm(h.Solver.quickHull,"quick hull")});this.controls.getGiftWrappingButton().on("click",function(b){a.runAlgorithm(h.Solver.giftWrapping,"gift wrapping")});this.controls.getPrimitiveButton().on("click",function(b){a.runAlgorithm(h.Solver.primitive,"primitive")});this.controls.getClearButton().on("click",function(b){a.canvas.clearSolution();a.setAlgButtonsDisabled(!1)})};b.prototype.generatePoints=function(a){for(this.points=
[];this.points.length<a;){for(var b=!1,c=this.canvas.getPadding()+Math.floor((this.canvas.getWidth()-2*this.canvas.getPadding())*Math.random()),e=this.canvas.getPadding()+Math.floor((this.canvas.getHeight()-2*this.canvas.getPadding())*Math.random()),f=0,g=this.points.length;f<g;f++)if(this.points[f].getX()===c||this.points[f].getY()===e){b=!0;break}b||this.points.push(new h.Point(c,e,f))}};b.prototype.runAlgorithm=function(a,b){var c=(new Date).getTime(),e=a(this.points),c=(new Date).getTime()-c;
this.canvas.drawPolygon(e.getPolygon(),"#44f","#99f");this.canvas.operationCountInfo(e.getCounter(),c,b)};b.prototype.setAlgButtonsDisabled=function(a){void 0===a&&(a=!0);this.processAlgButtons(function(b){b.attr("disabled",a?!0:null)});this.controls.getClearButton().attr("disabled",a?null:!0)};b.prototype.processAlgButtons=function(a){for(var b=[this.controls.getQuickHullButton(),this.controls.getGiftWrappingButton(),this.controls.getPrimitiveButton()],c=0,e=b.length;c<e;c++)a(b[c])};return b}();
h.Program=f})(ConvexHull||(ConvexHull={}));(function(h,f){var b=new ConvexHull.Canvas(f("#canvas"),50),a=new ConvexHull.Controls(f("#point-count"),f("#point-count-info"),f("#generate"),f("#alg-quick-hull"),f("#alg-gift-wrapping"),f("#alg-primitive"),f("#clear"));(new ConvexHull.Program(b,a)).run()})(window,window.jQuery);
